<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>机器学习模型管理平台</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <h1>机器学习模型管理平台</h1>
        <p>上传数据集、训练模型、进行预测并生成 SHAP 可视化分析。</p>
    </header>

    <main>
        <section>
            <h2>1. 上传数据集</h2>
            <form id="upload-form">
                <input type="file" id="dataset-file" accept=".csv">
                <button type="submit">上传</button>
            </form>
            <div class="response" id="upload-response"></div>
        </section>

        <section>
            <h2>2. 可用数据集</h2>
            <button id="refresh-datasets">刷新数据集列表</button>
            <ul id="dataset-list"></ul>
        </section>

        <section>
            <h2>3. 训练模型</h2>
            <form id="train-form">
                <label>数据集名称 <input type="text" id="train-dataset" required></label>
                <label>目标列名 <input type="text" id="train-target" required></label>
                <label>模型名称 <input type="text" id="train-model-name" required></label>
                <label>模型类型
                    <select id="train-model-type">
                        <option value="random_forest">Random Forest</option>
                        <option value="xgboost">XGBoost</option>
                    </select>
                </label>
                <label>测试集占比 <input type="number" id="train-test-size" value="0.2" step="0.05" min="0.1" max="0.5"></label>
                <label>随机种子 <input type="number" id="train-random-state" value="42"></label>
                <button type="submit">开始训练</button>
            </form>
            <div class="response" id="train-response"></div>
        </section>

        <section>
            <h2>4. 模型列表</h2>
            <button id="refresh-models">刷新模型列表</button>
            <ul id="model-list"></ul>
        </section>

        <section>
            <h2>5. 预测</h2>
            <form id="predict-form">
                <label>模型名称 <input type="text" id="predict-model-name" required></label>
                <label>特征 JSON <textarea id="predict-features" rows="5" placeholder='{"feature1": 1, "feature2": "A"}'></textarea></label>
                <button type="submit">预测</button>
            </form>
            <div class="response" id="predict-response"></div>
        </section>

        <section>
            <h2>6. SHAP 可视化</h2>
            <form id="shap-form">
                <label>模型名称 <input type="text" id="shap-model-name" required></label>
                <label>采样数量 <input type="number" id="shap-sample-size" value="200" min="10" max="1000"></label>
                <button type="submit">生成 SHAP 图</button>
            </form>
            <div class="response" id="shap-response"></div>
            <img id="shap-image" alt="SHAP summary" style="display:none;" />
        </section>
    </main>

    <footer>
        <p>部署建议：使用 Uvicorn 或 Gunicorn 结合 FastAPI，可在宝塔面板中配置守护进程运行。</p>
    </footer>

    <script src="/static/js/app.js"></script>
</body>
</html>
